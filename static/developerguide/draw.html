
<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Drawing PDF with T4 &mdash; T4 Developer Guide</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link href="../_static/jquery-ui.css" rel="stylesheet" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

      <link rel="shortcut icon" href="../_static/favicon.ico" />  
  
  
  <link rel="canonical" href="add the root doc url heredraw.html" />
  

  
  
  
  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/underscore.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>
  <script type="text/javascript" src="../_static/language_data.js"></script>
  <script type="text/javascript" src="../_static/searchtools.js"></script>
  <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>
   
  
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Data Store" href="data_store.html" />
    <link rel="prev" title="T4 Cache APIs" href="cache.html" /> 
  

	<script>
    $(document).ready(function () {
      $(window).scroll(function () {
        if ($(this).scrollTop() >= 50) {
          $('.fixedbar, .wy-nav-side').addClass('scroll');
          $('.wy-top-menu-wrapper').fadeOut();
        } else {
          $('.fixedbar, .wy-nav-side').removeClass('scroll');
          $('.wy-top-menu-wrapper').fadeIn();
        }
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 100) {
          $('#scroll').fadeIn();
        } else {
          $('#scroll').fadeOut();
        }
      });
      $('#scroll').click(function () {
        $("html, body").animate({ scrollTop: 0 }, 600);
        return false;
      });
    });
  </script>

<style>
  .wy-nav-content {max-width:90%}
  </style>
</head>

<body class="wy-body-for-nav">


  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
	  
	  	  
<!-- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
        <div class="wy-logo-wrapper">
          <a href="https://www.adobe.com">
            <img src="../_static/acrobaticon.png" class="logo"/>Adobe T4 Documentation</a>
        </div> 
 <!-- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
 
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> T4 Developer Guide
          

          
          </a>


          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="writingcppint4.html">C++ Best Practices for T4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="writingcppint4.html#the-most-important-thing">The Most Important Thing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#two-important-questions">Two Important Questions</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#let-s-not-kid-ourselves">Let’s Not Kid Ourselves</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="writingcppint4.html#typographic-conventions">Typographic Conventions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#identifiers">Identifiers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="writingcppint4.html#case-underbars">Case, Underbars</a></li>
<li class="toctree-l4"><a class="reference internal" href="writingcppint4.html#prefixing-suffixing">Prefixing/Suffixing</a></li>
<li class="toctree-l4"><a class="reference internal" href="writingcppint4.html#macros">Macros</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#tabs">Tabs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="writingcppint4.html#xcode-and-tabs">Xcode and Tabs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#braces-indentation-and-carriage-returns">Braces, Indentation and Carriage Returns</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#parentheses">Parentheses</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="writingcppint4.html#code-organization">Code Organization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#file-organization">File Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#writing-a-class">Writing a Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="writingcppint4.html#also-acceptable-raw-structs">Also Acceptable: Raw Structs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="writingcppint4.html#best-practices">Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#error-handling">Error Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#resource-acquisition-is-initialization-raii">Resource Acquisition Is Initialization (RAII)</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#return-values">Return Values</a><ul>
<li class="toctree-l4"><a class="reference internal" href="writingcppint4.html#multiple-return-values">Multiple Return Values</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#inheritance">Inheritance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="writingcppint4.html#the-override-keyword">The override keyword</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#shared-and-unique-pointers">Shared and Unique Pointers</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#namespaces">Namespaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#integers">Integers</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#alphabetization">Alphabetization</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#platform-architecture-and-os-specific-code">Platform, Architecture and OS Specific Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#geometry">Geometry</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="t4fileorganization.html">T4 File Organization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="t4fileorganization.html#about-header-files">About Header Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="t4fileorganization.html#where-everything-goes">Where Everything Goes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="t4fileorganization.html#about-detail-namespaces">About Detail Namespaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4fileorganization.html#implementation-headers">Implementation Headers</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4fileorganization.html#how-far-to-go-with-this">How Far to Go With This</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4fileorganization.html#going-even-farther">Going Even Farther</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="t4andexceptions.html">T4 and Exceptions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="t4andexceptions.html#but-let-s-not-kid-ourselves">But Let’s Not Kid Ourselves</a></li>
<li class="toctree-l2"><a class="reference internal" href="t4andexceptions.html#the-gruesome-details">The Gruesome Details</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="t4testing.html">Testing T4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="t4testing.html#t4-test">t4-test</a><ul>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#building-t4-test">Building t4-test</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#first-steps">First steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#concepts">Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#modes-of-execution">Modes of Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#t4-test-on-ios"><code class="docutils literal notranslate"><span class="pre">t4-test</span></code> on iOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#performance">Performance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="t4testing.html#implementation-details-how-t4-test-measures-performance">Implementation Details: How t4-test Measures Performance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#output">Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#other-options">Other Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#other-t4-test-features">Other t4-test Features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="t4testing.html#rendering">Rendering</a></li>
<li class="toctree-l4"><a class="reference internal" href="t4testing.html#text-extraction">Text Extraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="t4testing.html#document-info">Document Info</a></li>
<li class="toctree-l4"><a class="reference internal" href="t4testing.html#requesting-multiple-pages">Requesting Multiple Pages</a></li>
<li class="toctree-l4"><a class="reference internal" href="t4testing.html#accessibility-info-extraction">Accessibility Info Extraction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#tbd">TBD</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#cross-engine-comparison">Cross engine comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#building-pdfium">Building PDFium</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#executing-t4-vs-pdfium-tests">Executing t4 vs pdfium tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="t4testing.html#t4x">t4x</a><ul>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#rationale">Rationale</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="helloworld.html">Hello World How Tos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#t4-projects">T4 Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#writing-a-t4-client-in-xcode">Writing a T4 Client in Xcode</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#initialization-and-termination">Initialization and Termination</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#the-context-lock">The Context Lock</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#create-a-document-from-a-file-path">Create a document from a File Path</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#traverse-the-store-as-in-the-cos-api">Traverse the Store (as in the COS API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#extract-text">Extract Text</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#get-a-page-s-dimensions-and-rotation">Get a Page’s Dimensions and Rotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#render-a-page">Render a Page</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cache.html">T4 Cache APIs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cache.html#cache-overview">Cache Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cache.html#example-factorization-cache">Example: Factorization Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="cache.html#implementing-a-cache">Implementing a Cache</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cache.html#advanced-techniques">Advanced Techniques</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cache.html#caching-runtime-polymorphic-objects">Caching Runtime Polymorphic Objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="cache.html#returning-a-different-key-from-the-requested-one">Returning a Different Key from the Requested One</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cache.html#notes-about-the-cache">Notes about the Cache</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cache.html#thread-safety">Thread Safety</a></li>
<li class="toctree-l3"><a class="reference internal" href="cache.html#const">Const</a></li>
<li class="toctree-l3"><a class="reference internal" href="cache.html#purging">Purging</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cache.html#other-interesting-cache-features">Other Interesting Cache Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cache.html#memory-thresholds">Memory Thresholds</a></li>
<li class="toctree-l3"><a class="reference internal" href="cache.html#computing-cached-object-sizes">Computing Cached Object Sizes</a></li>
<li class="toctree-l3"><a class="reference internal" href="cache.html#update-your-object-s-size">Update Your Object’s Size</a></li>
<li class="toctree-l3"><a class="reference internal" href="cache.html#resource-pools">Resource Pools</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Drawing PDF with T4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#using-display-event-stream">Using <code class="docutils literal notranslate"><span class="pre">display_event_stream</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data_store.html">Data Store</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data_store.html#data-block">data_block</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_store.html#id1">data_store</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_store.html#data-block-stream">data_block_stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_store.html#comparison-data-store-and-data-block-stream">Comparison: data_store and data_block_stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_store.html#creating-data-stores">Creating data_stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_store.html#creating-your-own-data-store">Creating Your Own data_store</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_store.html#creating-your-own-data-block-stream">Creating Your Own data_block_stream</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="int_union.html">Using int_union</a><ul>
<li class="toctree-l2"><a class="reference internal" href="int_union.html#xprogrammers-xset-theorists">∀x∈Programmers:x∈Set Theorists</a><ul>
<li class="toctree-l3"><a class="reference internal" href="int_union.html#the-int-union-template">The int_union Template</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="int_union.html#assignment-and-comparison">Assignment and Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="int_union.html#integral-math">Integral Math</a></li>
<li class="toctree-l2"><a class="reference internal" href="int_union.html#integral-conversion">Integral Conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="int_union.html#performance-and-safety-considerations">Performance and Safety Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="int_union.html#correctness-implications-and-implementation-limits">Correctness Implications and Implementation Limits</a><ul>
<li class="toctree-l3"><a class="reference internal" href="int_union.html#the-special-template-parameters">The “Special” Template Parameters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="memory.html">T4 Memory APIs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="memory.html#a-quick-tour-of-t4-memory-facilities">A Quick Tour of T4 Memory Facilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="memory.html#memory-and-the-t4-cache">Memory and the T4 Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="memory.html#simple-allocation">Simple Allocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="memory.html#smart-pointers-and-containers">Smart Pointers and Containers</a></li>
<li class="toctree-l3"><a class="reference internal" href="memory.html#make-unique">make_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="memory.html#shared-ptr">shared_ptr</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="memory.html#memory-usage">Memory Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="memory.html#managing-memory-consumption">Managing Memory Consumption</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pagetree.html">Page Tree Navigation in T4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pagetree.html#choosing-the-right-type">Choosing the Right Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="pagetree.html#getting-from-one-type-to-another">Getting from One Type to Another</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="params.html">T4 Params Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="params.html#problem-statement">Problem Statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="params.html#approaches-to-solving-this-problem">Approaches to Solving this Problem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="params.html#parameter-structs">Parameter Structs</a></li>
<li class="toctree-l3"><a class="reference internal" href="params.html#parameter-dictionaries">Parameter Dictionaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="params.html#parameter-soup">Parameter Soup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="params.html#using-t4-params">Using T4 Params</a><ul>
<li class="toctree-l3"><a class="reference internal" href="params.html#exposing-a-t4-params-based-api">Exposing a T4 Params-Based API</a></li>
<li class="toctree-l3"><a class="reference internal" href="params.html#extracting-parameters-from-a-parameters-dictionary">Extracting Parameters from a Parameters Dictionary</a></li>
<li class="toctree-l3"><a class="reference internal" href="params.html#invoking-a-t4-params-based-api">Invoking a T4 Params-Based API</a></li>
<li class="toctree-l3"><a class="reference internal" href="params.html#evolving-a-t4-params-based-api">Evolving a T4 Params-Based API</a></li>
<li class="toctree-l3"><a class="reference internal" href="params.html#compile-time-errors">Compile-Time Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="params.html#recommended-hybrid-approach">Recommended: Hybrid Approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="params.html#about-parameter-values">About Parameter Values</a></li>
<li class="toctree-l3"><a class="reference internal" href="params.html#required-value-parameters">Required Value Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="params.html#required-reference-parameters">Required Reference Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="params.html#optional-parameters">Optional Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="params.html#required-parameters-with-default-values">Required Parameters with Default Values</a></li>
<li class="toctree-l3"><a class="reference internal" href="params.html#parameter-descriptions-and-constexpr">Parameter Descriptions and constexpr</a></li>
<li class="toctree-l3"><a class="reference internal" href="params.html#abi-issues">ABI Issues</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tile_cache.html">Tile Cache</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tile_cache.html#the-basics">The Basics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#creating-a-pdf-tile-cache">Creating a pdf_tile_cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#controlling-a-pdf-tile-cache">Controlling a pdf_tile_cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#displaying-a-pdf-tile-cache-s-contents">Displaying a pdf_tile_cache’s Contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tile_cache.html#pdf-tile-cache-details">pdf_tile_cache Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#tile-cache-requesters">Tile Cache Requesters</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#bitmaps">Bitmaps</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#defining-the-bitmap-type">Defining the Bitmap Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#drawing-parameters">Drawing Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#tile-collections">Tile Collections</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#pdf-tile-cache-implementation-and-theory">pdf_tile_cache Implementation and Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#pdf-tile-cache-state">pdf_tile_cache State</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#about-painting-progress">About Painting Progress</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#pile-tiles-implementation">pile_tiles Implementation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="transient_heap.html">Transient Heap</a><ul>
<li class="toctree-l2"><a class="reference internal" href="transient_heap.html#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="transient_heap.html#transient-heap-applications">transient_heap Applications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="transient_heap.html#grow-only-or-immutable-graphs-of-heterogeneous-objects">Grow-Only or Immutable Graphs of Heterogeneous Objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="transient_heap.html#algorithm-lifetime-bound-transient-allocations">Algorithm-Lifetime Bound Transient Allocations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="transient_heap.html#destruction-of-objects-in-a-transient-heap">Destruction of Objects in a transient_heap</a></li>
<li class="toctree-l2"><a class="reference internal" href="transient_heap.html#snapshots">Snapshots</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="typed_bool.html">Typed Bool</a><ul>
<li class="toctree-l2"><a class="reference internal" href="typed_bool.html#existing-approaches">Existing Approaches</a><ul>
<li class="toctree-l3"><a class="reference internal" href="typed_bool.html#t4-typed-bool">t4::typed_bool</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

        <!--- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
        <div class="fixedbar">  
          <div class="wy-menu-items">
            
            <a href="../gettingstarted/index.html" class="topbarlink">Getting Started</a>  
            <a href="../developerguide/index.html" class="topbarlink">Developer Guide</a>  

          
          </div>  <!--
          <div class="sign-in">
            <a href="" class="btn btn-console">Jira or?</a>
            <a href="https://auth.services.adobe.com/en_US/index.html">Sign in?</a>
          </div>-->
        </div>
        <!--- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
   
      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">T4 Developer Guide</a>
        
      </nav>


      <div class="wy-nav-content">
      <a href="#" id="scroll" style="display:inline;"><span></span></a>
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Drawing PDF with T4</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="data_store.html" class="btn btn-neutral float-right" title="Data Store" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="cache.html" class="btn btn-neutral float-left" title="T4 Cache APIs" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="drawing-pdf-with-t4">
<h1>Drawing PDF with T4<a class="headerlink" href="#drawing-pdf-with-t4" title="Permalink to this headline">¶</a></h1>
<p>Reference: <a class="reference external" href="https://wiki.corp.adobe.com/display/t4/Drawing+PDF+with+T4">https://wiki.corp.adobe.com/display/t4/Drawing+PDF+with+T4</a></p>
<p>T4 is a lot more than just a PDF rendering engine, but PDF rendering is the main reason clients currently use it. Rendering a page of PDF goes through one of the overloads of the draw_page function, most likely this one:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;t4/pdf/draw_page.hpp&quot;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">draw_page</span><span class="p">(</span> <span class="kt">void</span><span class="o">*</span> <span class="n">pixels</span><span class="p">,</span>       <span class="o">//</span> <span class="n">pointer</span> <span class="n">to</span> <span class="n">the</span> <span class="n">BGRA</span> <span class="n">pixel</span> <span class="n">buffer</span><span class="p">.</span> <span class="n">The</span> <span class="n">first</span> <span class="n">pixel</span> <span class="n">is</span> <span class="n">at</span> <span class="p">(</span><span class="n">get_xmin</span><span class="p">(</span><span class="n">bounds</span><span class="p">),</span> <span class="n">get_ymin</span><span class="p">(</span><span class="n">bounds</span><span class="p">))</span>
        <span class="kt">size_t</span> <span class="n">scan_line_stride</span><span class="p">,</span>    <span class="c1">// The distance in bytes between (x,y) and (x,y+1)</span>
        <span class="n">document</span><span class="o">&amp;</span> <span class="n">doc</span><span class="p">,</span> <span class="n">dictionary</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">pg</span><span class="p">,</span>
        <span class="n">affine_transform</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">base_page_xform</span><span class="p">,</span>
        <span class="n">affine_transform</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">page_to_device_xform</span><span class="p">,</span>
        <span class="n">int_rect</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">bounds</span><span class="p">,</span>
        <span class="n">draw_parameters</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">params</span> <span class="o">=</span> <span class="n">draw_parameters_desc</span><span class="p">()</span> <span class="p">);</span>
</pre></div>
</div>
<p>In its current incarnation, draw_page can only produce pixels in BGRA format. The pixels and scan_line_stride parameters describe the layout of the pixels provided by the client.</p>
<p>doc is the document whose contents are being rendered. pg is the dictionary for the page being rendered. You can get a page dictionary from a page number, page id or indirect reference using any of the <a class="reference internal" href="pagetree.html"><span class="doc">get_page_dictionary</span></a> overloads.</p>
<p>base_page_xform identifies the transformation from default unscaled page space to device space. This is only used by the code which renders /NoRotate and /NoZoom annotations. For example, if you were rendering to a screen with 144 DPI density, this transform would be a 2x scale.</p>
<p>page_to_device_xform identifies the transformation from default page space to device space.</p>
<p>bounds is the clip rectangle; the top left corner of this rectangle corresponds to the pixel at the address specified by pixels. This is the only way the caller communicates to draw_page the full extent of the pixel buffer, so it is important that you get this right.</p>
<p>params is a <a class="reference internal" href="params.html"><span class="doc">t4::params</span></a> type-safe dictionary which enumerates various other optional, or required-with-default parameters which can affect the rendering. This is a slightly more complicated mechanism than simply adding a bunch of parameters to draw_page, but it isn’t that complicated and using this mechanism allows us to evolve the draw_page API without breaking old client code. Here’s a simple example of how to use draw_parameters to set the “greek threshold” parameter (an integer) to 3:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="n">dparams</span> <span class="o">=</span> <span class="n">t4</span><span class="o">::</span><span class="n">pdf</span><span class="o">::</span><span class="n">dparams</span><span class="p">;</span>
<span class="k">using</span> <span class="n">t4</span><span class="o">::</span><span class="n">pdf</span><span class="o">::</span><span class="n">draw_parameters_desc</span><span class="p">;</span>
<span class="k">using</span> <span class="n">t4</span><span class="o">::</span><span class="n">parameter</span><span class="p">;</span>

<span class="k">auto</span> <span class="n">params</span> <span class="o">=</span> <span class="n">draw_parameters_desc</span><span class="p">(</span> <span class="n">parameter</span><span class="o">&lt;</span><span class="n">dparams</span><span class="o">::</span><span class="n">greek_threshold</span><span class="o">&gt;</span><span class="p">(</span> <span class="mi">3</span> <span class="p">)</span> <span class="p">);</span>
<span class="n">draw_page</span><span class="p">(</span> <span class="n">pixels</span><span class="p">,</span> <span class="n">scan_line_stride</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">pg</span><span class="p">,</span> <span class="n">base_page_xform</span><span class="p">,</span> <span class="n">page_to_device_xform</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">params</span> <span class="p">);</span>
</pre></div>
</div>
<p>You can copy and mutate existing parameter lists:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span> <span class="nf">draw_page_but_replace_greek_threshold</span><span class="p">(</span> <span class="kt">void</span><span class="o">*</span> <span class="n">pixels</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">scan_line_stride</span><span class="p">,</span>
        <span class="n">document</span><span class="o">&amp;</span> <span class="n">doc</span><span class="p">,</span> <span class="n">dictionary</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">pg</span><span class="p">,</span>
        <span class="n">affine_transform</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">base_page_xform</span><span class="p">,</span> <span class="n">affine_transform</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">page_to_device_xform</span><span class="p">,</span>
        <span class="n">int_rect</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">bounds</span><span class="p">,</span>
        <span class="n">draw_parameters</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">params</span><span class="p">,</span>
        <span class="kt">size_t</span> <span class="n">new_greek_threshold</span> <span class="p">)</span>
<span class="p">{</span>
        <span class="k">auto</span> <span class="n">new_params</span> <span class="o">=</span> <span class="n">params</span><span class="p">;</span>
        <span class="n">params</span> <span class="o">+=</span> <span class="n">parameter</span><span class="o">&lt;</span><span class="n">dparams</span><span class="o">::</span><span class="n">greek_threshold</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">new_greek_threshold</span> <span class="p">);</span>
        <span class="n">draw_page</span><span class="p">(</span> <span class="n">pixels</span><span class="p">,</span> <span class="n">scan_line_stride</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">pg</span><span class="p">,</span> <span class="n">base_page_xform</span><span class="p">,</span> <span class="n">page_to_device_xform</span><span class="p">,</span> <span class="n">bounds</span><span class="p">,</span> <span class="n">new_params</span> <span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As of this writing draw_page handles the following parameters in its draw_parameters dictionary:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Identifier</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Optional/Default Value</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>reflow_params</p></td>
<td><p>t4::pdf::reflow_layout_params</p></td>
<td><p>optional</p></td>
<td><p>If present, describes the reflow layout to use when rendering the page.</p></td>
</tr>
<tr class="row-odd"><td><p>mcids</p></td>
<td><p>t4::vector&lt;int&gt; const&amp;</p></td>
<td><p>optional</p></td>
<td><p>If present, only the MCIDs in this vector are actually rendered.</p></td>
</tr>
<tr class="row-even"><td><p>greek_threshold</p></td>
<td><p>t4::int_coord</p></td>
<td><p>default = 2</p></td>
<td><p>Glyphs less than or equal to this size in pixels are rendered using a greeking algorithm</p></td>
</tr>
<tr class="row-odd"><td><p>draw_client</p></td>
<td><p>t4::pdf::draw_client</p></td>
<td><p>An instance of draw_client that doesn’t do anything</p></td>
<td><p>Object which handles periodic mark calls during drawing, drawing_finished at completion. Also supports override_annotation_appearance for certain use cases in annotation rendering.</p></td>
</tr>
<tr class="row-even"><td><p>required_border_color</p></td>
<td><p>std::uint32_t</p></td>
<td><p>0x80000000</p></td>
<td><p>Border color for “required” annotations</p></td>
</tr>
<tr class="row-odd"><td><p>optional_border_color</p></td>
<td><p>std::uint32_t</p></td>
<td><p>0x80000000</p></td>
<td><p>Border color for “optional” annotations</p></td>
</tr>
<tr class="row-even"><td><p>display_event_stream</p></td>
<td><p>t4::pdf::display_event_stream</p></td>
<td><p>An instance of display_event_stream which ignores all events</p></td>
<td><p>Object which handles reports of interesting properties encountered during rendering, such as knockout transparency or unsupported rendering features.</p></td>
</tr>
<tr class="row-odd"><td><p>draw_annotations</p></td>
<td><p>t4::pdf::draw_annotations_flag</p></td>
<td><p>draw_annotations_flag::yes</p></td>
<td><p>Typed boolean which controls whether or not annotation rendering should occur</p></td>
</tr>
<tr class="row-even"><td><p>optional_content</p></td>
<td><p>t4::pdf::optional_content_state</p></td>
<td><p>Default OC state for page at document open</p></td>
<td><p>Explicitly specify which optional content groups should and should not be rendered</p></td>
</tr>
</tbody>
</table>
<p>Every entry in the <strong>Identifier</strong> column is in the <code class="docutils literal notranslate"><span class="pre">t4::pdf::dparams</span></code> namespace.</p>
<div class="section" id="using-display-event-stream">
<h2>Using <code class="docutils literal notranslate"><span class="pre">display_event_stream</span></code><a class="headerlink" href="#using-display-event-stream" title="Permalink to this headline">¶</a></h2>
<p>Occasionally clients may be interested to know whether or not a rendering contains certain properties that aren’t easily discovered without simply traversing the content. For example, after a rendering it might be useful to know if any unusable fonts were encountered, or certain “interesting” transparency properties (e.g., knockout groups) beyond the capabilities of non-T4 renderers existed.</p>
<p>The display_event_stream class exists to report “events” of these sorts back to a caller of draw_page.</p>
<p>For each kind of “event” there exists a class describing the properties of that event. Here is a complete list of the different event types supported by T4 as of this writing:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">transparency_group_event</span>
<span class="p">{</span>
<span class="n">is_knockout</span> <span class="n">m_knockout</span><span class="p">;</span>
<span class="n">is_isolated</span> <span class="n">m_isolated</span><span class="p">;</span>

<span class="k">public</span><span class="o">:</span>
<span class="n">transparency_group_event</span><span class="p">(</span><span class="n">is_knockout</span> <span class="n">ko</span><span class="p">,</span> <span class="n">is_isolated</span> <span class="n">i</span><span class="p">)</span>
        <span class="o">:</span> <span class="n">m_knockout</span><span class="p">(</span><span class="n">ko</span><span class="p">),</span>
        <span class="n">m_isolated</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="p">{}</span>

<span class="n">is_knockout</span> <span class="n">is_knockout</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_knockout</span><span class="p">;</span> <span class="p">}</span>
<span class="n">is_isolated</span> <span class="n">is_isolated</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_isolated</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">non_normal_blend_mode_event</span>
<span class="p">{</span>
<span class="n">t3</span><span class="o">::</span><span class="n">pdf</span><span class="o">::</span><span class="n">content</span><span class="o">::</span><span class="n">BlendMode</span> <span class="n">m_blend_mode</span><span class="p">;</span>

<span class="k">public</span><span class="o">:</span>
<span class="n">non_normal_blend_mode_event</span><span class="p">(</span><span class="n">t3</span><span class="o">::</span><span class="n">pdf</span><span class="o">::</span><span class="n">content</span><span class="o">::</span><span class="n">BlendMode</span> <span class="n">bm</span><span class="p">)</span>
        <span class="o">:</span> <span class="n">m_blend_mode</span><span class="p">(</span><span class="n">bm</span><span class="p">)</span>
<span class="p">{}</span>

<span class="n">t3</span><span class="o">::</span><span class="n">pdf</span><span class="o">::</span><span class="n">content</span><span class="o">::</span><span class="n">BlendMode</span> <span class="n">get_blend_mode</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">m_blend_mode</span><span class="p">;</span> <span class="p">}</span>
<span class="p">};</span>

<span class="k">class</span> <span class="nc">unusable_font_event</span>
<span class="p">{};</span>
</pre></div>
</div>
<p>We do intend to expand this list with new events as the need arises. When this occurs client code will need to be recompiled, but it should not require changes.</p>
<p>Clients may implement their own display_event_stream by writing a class with various stream operator overloads, e.g.:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span> <span class="nc">my_listener</span>
<span class="p">{</span>
<span class="kt">void</span> <span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">transparency_group_event</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">e</span><span class="p">)</span> <span class="k">const</span>
<span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;transparency group encountered. Isolated: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">boolalpha</span> <span class="o">&lt;&lt;</span> <span class="kt">bool</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">is_isolated</span><span class="p">())</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; Knockout: &quot;</span> <span class="o">&lt;&lt;</span> <span class="kt">bool</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">is_knockout</span><span class="p">())</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">non_normal_blend_mode_event</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">e</span><span class="p">)</span> <span class="k">const</span>
<span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Non-normal blend mode encountered: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">e</span><span class="p">.</span><span class="n">get_blend_mode</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="k">operator</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">unusable_font_event</span> <span class="k">const</span><span class="o">&amp;</span> <span class="n">e</span><span class="p">)</span> <span class="k">const</span>
<span class="p">{</span>
        <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Unusable font encountered</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>None of these callbacks are <em>required</em>; if one is omitted then a default implementation that does nothing will be provided for you.</p>
<p>Once you’ve got your class coded up, you use make_display_event_stream to create a display_event_stream object:</p>
<blockquote>
<div><p>display_event_stream event_stm = make_display_event_stream(my_listener());</p>
</div></blockquote>
<p>You can then use it with <code class="docutils literal notranslate"><span class="pre">`draw_parameters`</span></code>:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">namespace</span> <span class="n">dparams</span> <span class="o">=</span> <span class="n">pdf</span><span class="o">::</span><span class="n">dparams</span><span class="p">;</span>

<span class="c1">// Create a draw_parameters struct initialized to the defaults, then set the display_event_stream member</span>
<span class="k">auto</span> <span class="n">dp</span> <span class="o">=</span> <span class="n">draw_parameters_desc</span><span class="p">(</span>
        <span class="n">parameter</span><span class="o">&lt;</span><span class="n">dparams</span><span class="o">::</span><span class="n">display_event_stream</span><span class="o">&gt;</span><span class="p">(</span><span class="n">event_stm</span><span class="p">));</span>
</pre></div>
</div>
<p>Then, when you draw a page, your various <code class="docutils literal notranslate"><span class="pre">`my_listener`</span></code> callbacks will be called. For example:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">draw_page</span><span class="p">(</span><span class="n">my_doc</span><span class="p">,</span> <span class="n">get_page_dictionary</span><span class="p">(</span><span class="n">my_doc</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">xform1</span><span class="p">,</span> <span class="n">xform2</span><span class="p">,</span> <span class="n">clip</span><span class="p">,</span> <span class="n">draw_params</span><span class="p">);</span>

<span class="n">Possible</span> <span class="nl">output</span><span class="p">:</span>
<span class="n">transparency</span> <span class="n">group</span> <span class="n">encountered</span><span class="p">.</span> <span class="nl">Isolated</span><span class="p">:</span> <span class="nb">true</span> <span class="nl">Knockout</span><span class="p">:</span> <span class="nb">false</span>
<span class="n">Unusable</span> <span class="n">font</span> <span class="n">encountered</span>
<span class="n">Non</span><span class="o">-</span><span class="n">normal</span> <span class="n">blend</span> <span class="n">mode</span> <span class="nl">encountered</span><span class="p">:</span> <span class="n">screen</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Adobe Inc..
      <span class="lastupdated">
        Last update: Aug 30, 2021. 
        <img src="../_static/adobelogo.png" class="logo"/> 
      </span>

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>