
<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>T4 Params Module &mdash; T4 Developer Guide</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link href="../_static/jquery-ui.css" rel="stylesheet" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />

      <link rel="shortcut icon" href="../_static/favicon.ico" />  
  
  
  <link rel="canonical" href="add the root doc url hereparams.html" />
  

  
  
  
  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/underscore.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>
  <script type="text/javascript" src="../_static/language_data.js"></script>
  <script type="text/javascript" src="../_static/searchtools.js"></script>
  <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>
   
  
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tile Cache" href="tile_cache.html" />
    <link rel="prev" title="Page Tree Navigation in T4" href="pagetree.html" /> 
  

	<script>
    $(document).ready(function () {
      $(window).scroll(function () {
        if ($(this).scrollTop() >= 50) {
          $('.fixedbar, .wy-nav-side').addClass('scroll');
          $('.wy-top-menu-wrapper').fadeOut();
        } else {
          $('.fixedbar, .wy-nav-side').removeClass('scroll');
          $('.wy-top-menu-wrapper').fadeIn();
        }
      });
      $(window).scroll(function () {
        if ($(this).scrollTop() > 100) {
          $('#scroll').fadeIn();
        } else {
          $('#scroll').fadeOut();
        }
      });
      $('#scroll').click(function () {
        $("html, body").animate({ scrollTop: 0 }, 600);
        return false;
      });
    });
  </script>

<style>
  .wy-nav-content {max-width:90%}
  </style>
</head>

<body class="wy-body-for-nav">


  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
	  
	  	  
<!-- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
        <div class="wy-logo-wrapper">
          <a href="https://www.adobe.com">
            <img src="../_static/acrobaticon.png" class="logo"/>Adobe T4 Documentation</a>
        </div> 
 <!-- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
 
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> T4 Developer Guide
          

          
          </a>


          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="writingcppint4.html">C++ Best Practices for T4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="writingcppint4.html#the-most-important-thing">The Most Important Thing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#two-important-questions">Two Important Questions</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#let-s-not-kid-ourselves">Let’s Not Kid Ourselves</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="writingcppint4.html#typographic-conventions">Typographic Conventions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#identifiers">Identifiers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="writingcppint4.html#case-underbars">Case, Underbars</a></li>
<li class="toctree-l4"><a class="reference internal" href="writingcppint4.html#prefixing-suffixing">Prefixing/Suffixing</a></li>
<li class="toctree-l4"><a class="reference internal" href="writingcppint4.html#macros">Macros</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#tabs">Tabs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="writingcppint4.html#xcode-and-tabs">Xcode and Tabs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#braces-indentation-and-carriage-returns">Braces, Indentation and Carriage Returns</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#parentheses">Parentheses</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="writingcppint4.html#code-organization">Code Organization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#file-organization">File Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#writing-a-class">Writing a Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="writingcppint4.html#also-acceptable-raw-structs">Also Acceptable: Raw Structs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="writingcppint4.html#best-practices">Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#error-handling">Error Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#resource-acquisition-is-initialization-raii">Resource Acquisition Is Initialization (RAII)</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#return-values">Return Values</a><ul>
<li class="toctree-l4"><a class="reference internal" href="writingcppint4.html#multiple-return-values">Multiple Return Values</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#inheritance">Inheritance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="writingcppint4.html#the-override-keyword">The override keyword</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#shared-and-unique-pointers">Shared and Unique Pointers</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#namespaces">Namespaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#integers">Integers</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#alphabetization">Alphabetization</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#platform-architecture-and-os-specific-code">Platform, Architecture and OS Specific Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="writingcppint4.html#geometry">Geometry</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="t4fileorganization.html">T4 File Organization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="t4fileorganization.html#about-header-files">About Header Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="t4fileorganization.html#where-everything-goes">Where Everything Goes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="t4fileorganization.html#about-detail-namespaces">About Detail Namespaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4fileorganization.html#implementation-headers">Implementation Headers</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4fileorganization.html#how-far-to-go-with-this">How Far to Go With This</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4fileorganization.html#going-even-farther">Going Even Farther</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="t4andexceptions.html">T4 and Exceptions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="t4andexceptions.html#but-let-s-not-kid-ourselves">But Let’s Not Kid Ourselves</a></li>
<li class="toctree-l2"><a class="reference internal" href="t4andexceptions.html#the-gruesome-details">The Gruesome Details</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="t4testing.html">Testing T4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="t4testing.html#t4-test">t4-test</a><ul>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#building-t4-test">Building t4-test</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#first-steps">First steps</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#concepts">Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#modes-of-execution">Modes of Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#t4-test-on-ios"><code class="docutils literal notranslate"><span class="pre">t4-test</span></code> on iOS</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#performance">Performance</a><ul>
<li class="toctree-l4"><a class="reference internal" href="t4testing.html#implementation-details-how-t4-test-measures-performance">Implementation Details: How t4-test Measures Performance</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#output">Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#other-options">Other Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#other-t4-test-features">Other t4-test Features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="t4testing.html#rendering">Rendering</a></li>
<li class="toctree-l4"><a class="reference internal" href="t4testing.html#text-extraction">Text Extraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="t4testing.html#document-info">Document Info</a></li>
<li class="toctree-l4"><a class="reference internal" href="t4testing.html#requesting-multiple-pages">Requesting Multiple Pages</a></li>
<li class="toctree-l4"><a class="reference internal" href="t4testing.html#accessibility-info-extraction">Accessibility Info Extraction</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#tbd">TBD</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#cross-engine-comparison">Cross engine comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#building-pdfium">Building PDFium</a></li>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#executing-t4-vs-pdfium-tests">Executing t4 vs pdfium tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="t4testing.html#t4x">t4x</a><ul>
<li class="toctree-l3"><a class="reference internal" href="t4testing.html#rationale">Rationale</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="helloworld.html">Hello World How Tos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#t4-projects">T4 Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#writing-a-t4-client-in-xcode">Writing a T4 Client in Xcode</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#initialization-and-termination">Initialization and Termination</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#the-context-lock">The Context Lock</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#create-a-document-from-a-file-path">Create a document from a File Path</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#traverse-the-store-as-in-the-cos-api">Traverse the Store (as in the COS API)</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#extract-text">Extract Text</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#get-a-page-s-dimensions-and-rotation">Get a Page’s Dimensions and Rotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="helloworld.html#render-a-page">Render a Page</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cache.html">T4 Cache APIs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cache.html#cache-overview">Cache Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cache.html#example-factorization-cache">Example: Factorization Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="cache.html#implementing-a-cache">Implementing a Cache</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cache.html#advanced-techniques">Advanced Techniques</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cache.html#caching-runtime-polymorphic-objects">Caching Runtime Polymorphic Objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="cache.html#returning-a-different-key-from-the-requested-one">Returning a Different Key from the Requested One</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cache.html#notes-about-the-cache">Notes about the Cache</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cache.html#thread-safety">Thread Safety</a></li>
<li class="toctree-l3"><a class="reference internal" href="cache.html#const">Const</a></li>
<li class="toctree-l3"><a class="reference internal" href="cache.html#purging">Purging</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cache.html#other-interesting-cache-features">Other Interesting Cache Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="cache.html#memory-thresholds">Memory Thresholds</a></li>
<li class="toctree-l3"><a class="reference internal" href="cache.html#computing-cached-object-sizes">Computing Cached Object Sizes</a></li>
<li class="toctree-l3"><a class="reference internal" href="cache.html#update-your-object-s-size">Update Your Object’s Size</a></li>
<li class="toctree-l3"><a class="reference internal" href="cache.html#resource-pools">Resource Pools</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="draw.html">Drawing PDF with T4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="draw.html#using-display-event-stream">Using <code class="docutils literal notranslate"><span class="pre">display_event_stream</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data_store.html">Data Store</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data_store.html#data-block">data_block</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_store.html#id1">data_store</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_store.html#data-block-stream">data_block_stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_store.html#comparison-data-store-and-data-block-stream">Comparison: data_store and data_block_stream</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_store.html#creating-data-stores">Creating data_stores</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_store.html#creating-your-own-data-store">Creating Your Own data_store</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_store.html#creating-your-own-data-block-stream">Creating Your Own data_block_stream</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="int_union.html">Using int_union</a><ul>
<li class="toctree-l2"><a class="reference internal" href="int_union.html#xprogrammers-xset-theorists">∀x∈Programmers:x∈Set Theorists</a><ul>
<li class="toctree-l3"><a class="reference internal" href="int_union.html#the-int-union-template">The int_union Template</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="int_union.html#assignment-and-comparison">Assignment and Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="int_union.html#integral-math">Integral Math</a></li>
<li class="toctree-l2"><a class="reference internal" href="int_union.html#integral-conversion">Integral Conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="int_union.html#performance-and-safety-considerations">Performance and Safety Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="int_union.html#correctness-implications-and-implementation-limits">Correctness Implications and Implementation Limits</a><ul>
<li class="toctree-l3"><a class="reference internal" href="int_union.html#the-special-template-parameters">The “Special” Template Parameters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="memory.html">T4 Memory APIs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="memory.html#a-quick-tour-of-t4-memory-facilities">A Quick Tour of T4 Memory Facilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="memory.html#memory-and-the-t4-cache">Memory and the T4 Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="memory.html#simple-allocation">Simple Allocation</a></li>
<li class="toctree-l3"><a class="reference internal" href="memory.html#smart-pointers-and-containers">Smart Pointers and Containers</a></li>
<li class="toctree-l3"><a class="reference internal" href="memory.html#make-unique">make_unique</a></li>
<li class="toctree-l3"><a class="reference internal" href="memory.html#shared-ptr">shared_ptr</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="memory.html#memory-usage">Memory Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="memory.html#managing-memory-consumption">Managing Memory Consumption</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pagetree.html">Page Tree Navigation in T4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pagetree.html#choosing-the-right-type">Choosing the Right Type</a></li>
<li class="toctree-l2"><a class="reference internal" href="pagetree.html#getting-from-one-type-to-another">Getting from One Type to Another</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">T4 Params Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#problem-statement">Problem Statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="#approaches-to-solving-this-problem">Approaches to Solving this Problem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#parameter-structs">Parameter Structs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameter-dictionaries">Parameter Dictionaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameter-soup">Parameter Soup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-t4-params">Using T4 Params</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exposing-a-t4-params-based-api">Exposing a T4 Params-Based API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extracting-parameters-from-a-parameters-dictionary">Extracting Parameters from a Parameters Dictionary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#invoking-a-t4-params-based-api">Invoking a T4 Params-Based API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#evolving-a-t4-params-based-api">Evolving a T4 Params-Based API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compile-time-errors">Compile-Time Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#recommended-hybrid-approach">Recommended: Hybrid Approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="#about-parameter-values">About Parameter Values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#required-value-parameters">Required Value Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#required-reference-parameters">Required Reference Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optional-parameters">Optional Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#required-parameters-with-default-values">Required Parameters with Default Values</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameter-descriptions-and-constexpr">Parameter Descriptions and constexpr</a></li>
<li class="toctree-l3"><a class="reference internal" href="#abi-issues">ABI Issues</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tile_cache.html">Tile Cache</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tile_cache.html#the-basics">The Basics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#creating-a-pdf-tile-cache">Creating a pdf_tile_cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#controlling-a-pdf-tile-cache">Controlling a pdf_tile_cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#displaying-a-pdf-tile-cache-s-contents">Displaying a pdf_tile_cache’s Contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tile_cache.html#pdf-tile-cache-details">pdf_tile_cache Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#tile-cache-requesters">Tile Cache Requesters</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#bitmaps">Bitmaps</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#defining-the-bitmap-type">Defining the Bitmap Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#drawing-parameters">Drawing Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#tile-collections">Tile Collections</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#pdf-tile-cache-implementation-and-theory">pdf_tile_cache Implementation and Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#pdf-tile-cache-state">pdf_tile_cache State</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#about-painting-progress">About Painting Progress</a></li>
<li class="toctree-l3"><a class="reference internal" href="tile_cache.html#pile-tiles-implementation">pile_tiles Implementation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="transient_heap.html">Transient Heap</a><ul>
<li class="toctree-l2"><a class="reference internal" href="transient_heap.html#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="transient_heap.html#transient-heap-applications">transient_heap Applications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="transient_heap.html#grow-only-or-immutable-graphs-of-heterogeneous-objects">Grow-Only or Immutable Graphs of Heterogeneous Objects</a></li>
<li class="toctree-l3"><a class="reference internal" href="transient_heap.html#algorithm-lifetime-bound-transient-allocations">Algorithm-Lifetime Bound Transient Allocations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="transient_heap.html#destruction-of-objects-in-a-transient-heap">Destruction of Objects in a transient_heap</a></li>
<li class="toctree-l2"><a class="reference internal" href="transient_heap.html#snapshots">Snapshots</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="typed_bool.html">Typed Bool</a><ul>
<li class="toctree-l2"><a class="reference internal" href="typed_bool.html#existing-approaches">Existing Approaches</a><ul>
<li class="toctree-l3"><a class="reference internal" href="typed_bool.html#t4-typed-bool">t4::typed_bool</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

        <!--- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
        <div class="fixedbar">  
          <div class="wy-menu-items">
            
            <a href="../gettingstarted/index.html" class="topbarlink">Getting Started</a>  
            <a href="../developerguide/index.html" class="topbarlink">Developer Guide</a>  

          
          </div>  <!--
          <div class="sign-in">
            <a href="" class="btn btn-console">Jira or?</a>
            <a href="https://auth.services.adobe.com/en_US/index.html">Sign in?</a>
          </div>-->
        </div>
        <!--- @@@@@@@@@@@@@@@@ Custom @@@@@@@@@@@@@@@@ -->
   
      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">T4 Developer Guide</a>
        
      </nav>


      <div class="wy-nav-content">
      <a href="#" id="scroll" style="display:inline;"><span></span></a>
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>T4 Params Module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="tile_cache.html" class="btn btn-neutral float-right" title="Tile Cache" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="pagetree.html" class="btn btn-neutral float-left" title="Page Tree Navigation in T4" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="t4-params-module">
<h1>T4 Params Module<a class="headerlink" href="#t4-params-module" title="Permalink to this headline">¶</a></h1>
<p>Reference: <a class="reference external" href="https://wiki.corp.adobe.com/display/t4/The+T4+Params+Module">https://wiki.corp.adobe.com/display/t4/The+T4+Params+Module</a></p>
<p>The T4 Params module’s purpose is to facilitate support for “complex” functions and methods, where we expect the contract with the caller to have some or all of the following properties:</p>
<ul>
<li><p>Many separate moving parts–lots of independent variables that don’t have any interdependency</p></li>
<li><p>Zero or more “optional” parameters, for which the “unspecified” state may be valid and interesting</p></li>
<li><p>Zero or more “required” parameters, some of which may have natural default values so the client need not explicitly specify them</p></li>
<li><p>The possibility of API evolution over time, specifically:</p>
<blockquote>
<div><ul class="simple">
<li><p>The addition of new optional parameters, or required parameters with default values, in a way that doesn’t break old client code</p></li>
<li><p>The addition of new required parameters in a way that does break old client code, and alerts the maintainer of the client code as to what sort of change is required</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<div class="section" id="problem-statement">
<h2>Problem Statement<a class="headerlink" href="#problem-statement" title="Permalink to this headline">¶</a></h2>
<p>Imagine a draw_page function that starts out looking like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">draw_page</span><span class="p">(</span><span class="n">document</span><span class="o">&amp;</span> <span class="n">doc</span><span class="p">,</span>
        <span class="n">page_num</span> <span class="n">page</span><span class="p">,</span>
        <span class="n">affine_transform</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">xform</span><span class="p">,</span>
        <span class="n">int_rect</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">clip</span><span class="p">,</span>
        <span class="n">writable_pixels</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">buffer</span><span class="p">);</span>
</pre></div>
</div>
<p>That’s simple enough. But then we invent reflow. To paint a reflowed page, we simply provide a reflow_layout argument. There are two possible approaches we might consider here: 1) add a reflow_layout const* argument which is allowed to be nullptr, or add an overload of draw_page which takes a reflow_layout const&amp;. Because raw pointer arguments give people the creeps, I’ve chosen the second option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">draw_page</span><span class="p">(</span><span class="n">document</span><span class="o">&amp;</span> <span class="n">doc</span><span class="p">,</span>
        <span class="n">page_num</span> <span class="n">page</span><span class="p">,</span>
        <span class="n">affine_transform</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">xform</span><span class="p">,</span>
        <span class="n">int_rect</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">clip</span><span class="p">,</span>
        <span class="n">writable_pixels</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">buffer</span><span class="p">);</span>

<span class="n">void</span> <span class="n">draw_page</span><span class="p">(</span><span class="n">document</span><span class="o">&amp;</span> <span class="n">doc</span><span class="p">,</span>
        <span class="n">page_num</span> <span class="n">page</span><span class="p">,</span>
        <span class="n">affine_transform</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">xform</span><span class="p">,</span>
        <span class="n">int_rect</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">clip</span><span class="p">,</span>
        <span class="n">reflow_layout</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">reflow</span><span class="p">,</span>
        <span class="n">writable_pixels</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">buffer</span><span class="p">);</span>
</pre></div>
</div>
<p>Then later we want to add a “greek threshold”–if we render text whose computed font size (in device space) is smaller than this number of pixels, we skip glyph rasterization and draw gray noise instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">draw_page</span><span class="p">(</span><span class="n">document</span><span class="o">&amp;</span> <span class="n">doc</span><span class="p">,</span>
        <span class="n">page_num</span> <span class="n">page</span><span class="p">,</span>
        <span class="n">affine_transform</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">xform</span><span class="p">,</span>
        <span class="n">int_rect</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">clip</span><span class="p">,</span>
        <span class="n">writable_pixels</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">buffer</span><span class="p">,</span>
        <span class="n">size_t</span> <span class="n">greek_threshold</span> <span class="o">=</span> <span class="mi">2</span><span class="p">);</span>

<span class="n">void</span> <span class="n">draw_page</span><span class="p">(</span><span class="n">document</span><span class="o">&amp;</span> <span class="n">doc</span><span class="p">,</span>
        <span class="n">page_num</span> <span class="n">page</span><span class="p">,</span>
        <span class="n">affine_transform</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">xform</span><span class="p">,</span>
        <span class="n">int_rect</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">clip</span><span class="p">,</span>
        <span class="n">reflow_layout</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">reflow</span><span class="p">,</span>
        <span class="n">writable_pixels</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">buffer</span><span class="p">,</span>
        <span class="n">size_t</span> <span class="n">greek_threshold</span> <span class="o">=</span> <span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<p>Note that we added it to the end of the parameter list and gave it a default value, so that old client code would still compile.</p>
<p>Oh, hey, now we want to add the ability to suppress rendering of annotations (but of course the default behavior should be to draw them):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">draw_page</span><span class="p">(</span><span class="n">document</span><span class="o">&amp;</span> <span class="n">doc</span><span class="p">,</span>
        <span class="n">page_num</span> <span class="n">page</span><span class="p">,</span>
        <span class="n">affine_transform</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">xform</span><span class="p">,</span>
        <span class="n">int_rect</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">clip</span><span class="p">,</span>
        <span class="n">writable_pixels</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">buffer</span><span class="p">,</span>
        <span class="n">size_t</span> <span class="n">greek_threshold</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="nb">bool</span> <span class="n">draw_annots</span> <span class="o">=</span> <span class="n">true</span> <span class="p">);</span>

<span class="n">void</span> <span class="n">draw_page</span><span class="p">(</span><span class="n">document</span><span class="o">&amp;</span> <span class="n">doc</span><span class="p">,</span>
        <span class="n">page_num</span> <span class="n">page</span><span class="p">,</span>
        <span class="n">affine_transform</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">xform</span><span class="p">,</span>
        <span class="n">int_rect</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">clip</span><span class="p">,</span>
        <span class="n">reflow_layout</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">reflow</span><span class="p">,</span>
        <span class="n">writable_pixels</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">buffer</span><span class="p">,</span>
        <span class="n">size_t</span> <span class="n">greek_threshold</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="nb">bool</span> <span class="n">draw_annots</span> <span class="o">=</span> <span class="n">true</span><span class="p">);</span>
</pre></div>
</div>
<p>You can see where this is going.</p>
</div>
<div class="section" id="approaches-to-solving-this-problem">
<h2>Approaches to Solving this Problem<a class="headerlink" href="#approaches-to-solving-this-problem" title="Permalink to this headline">¶</a></h2>
<p>Here are three of the more popular ways to address this problem:</p>
<div class="section" id="parameter-structs">
<h3>Parameter Structs<a class="headerlink" href="#parameter-structs" title="Permalink to this headline">¶</a></h3>
<p>If an API author anticipates this problem, they might create a simple struct with members for each of the parameters. You can use optional and (in C++11) default member initializers to approximate optional and required-with-default parameters, but the syntax is cumbersome and there really isn’t any easy way to describe a required parameter without a default value (you could, I suppose, provide a constructor that takes all the required-without-default parameters, and omit the default constructor, but that’s still very clumsy). This approach is typesafe, though, which is nice. But there isn’t really any good way to force a client to provide a required parameter that happens to have a default constructor.</p>
</div>
<div class="section" id="parameter-dictionaries">
<h3>Parameter Dictionaries<a class="headerlink" href="#parameter-dictionaries" title="Permalink to this headline">¶</a></h3>
<p>Apple APIs are riddled with NSDictionary “parameter dictionaries,” which solve this problem in a nice ABI-safe way, but you sacrifice compile-time type safety, you have to manage a string-based key space, and there’s a lot of runtime dynamism that isn’t really necessary. These aren’t terribly onerous burdens, especially if the API owner provides wrapper helper functions that restore type safety by compiling into client code. But we can do better.</p>
</div>
<div class="section" id="parameter-soup">
<h3>Parameter Soup<a class="headerlink" href="#parameter-soup" title="Permalink to this headline">¶</a></h3>
<p>This is basically the logical conclusion of doing nothing, i.e., continuing the approach described in the “Problem Statement” section until your function has 40 overloads with 30 parameters each.</p>
</div>
</div>
<div class="section" id="using-t4-params">
<h2>Using T4 Params<a class="headerlink" href="#using-t4-params" title="Permalink to this headline">¶</a></h2>
<p>Let’s solve this problem using the T4 Params module.</p>
<div class="section" id="exposing-a-t4-params-based-api">
<h3>Exposing a T4 Params-Based API<a class="headerlink" href="#exposing-a-t4-params-based-api" title="Permalink to this headline">¶</a></h3>
<p>Here’s how we might write draw_page before we had considered the other API additions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;t4/params.hpp&quot;</span>

<span class="n">using</span> <span class="n">namespace</span> <span class="n">t4</span><span class="p">;</span>

<span class="n">namespace</span> <span class="n">d_params</span> <span class="p">{</span>

<span class="n">struct</span> <span class="n">page</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="n">pdf</span><span class="p">::</span><span class="n">page_num</span><span class="o">&gt;</span> <span class="p">{};</span>
<span class="n">struct</span> <span class="n">xform</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="n">t4</span><span class="p">::</span><span class="n">affine_transform</span><span class="o">&gt;</span> <span class="p">{};</span>
<span class="n">struct</span> <span class="n">clip</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="n">t4</span><span class="p">::</span><span class="n">int_rect</span><span class="o">&gt;</span> <span class="p">{};</span>
<span class="n">struct</span> <span class="n">buffer</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="n">writable_pixels</span> <span class="n">const</span><span class="o">&amp;&gt;</span> <span class="p">{};</span>

<span class="p">}</span> <span class="o">//</span> <span class="n">end</span> <span class="n">namespace</span> <span class="n">d_params</span>
</pre></div>
</div>
<p>These types are called “parameter tags” and correspond to specific parameters in a parameter description. They must inherit from parameter_of_type, and that template class must be instantiated on the value type of the parameter. Above, we’ve sequestered these four classes ( page, xform, clip and buffer) in the d_params namespace. This is not required, but it’s a good practice because parameter names tend to be concise and the potential for collisions is high.</p>
<p>In the above example, the page class describes parameters of type pdf::page_num, the xform class describes parameters of type affine_transform, etc., etc.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">namespace</span> <span class="n">d_params</span><span class="p">;</span>
<span class="n">constexpr</span> <span class="n">auto</span> <span class="n">draw_parameters_desc</span> <span class="o">=</span> <span class="n">parameter_description</span><span class="p">(</span>
        <span class="n">required_parameter</span><span class="o">&lt;</span><span class="n">page</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="n">required_parameter</span><span class="o">&lt;</span><span class="n">xform</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="n">required_parameter</span><span class="o">&lt;</span><span class="n">clip</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="n">required_parameter</span><span class="o">&lt;</span><span class="n">buffer</span><span class="o">&gt;</span><span class="p">);</span>
</pre></div>
</div>
<p>We then define a global object named draw_parameters_desc that describes the parameters taken by draw_page.</p>
<p>The result of calling parameter_description is a function object that takes a list of individual parameter descriptors. In the above example, the four descriptors required_parameter&lt;page&gt;, required_parameter&lt;xform&gt;, etc. all indicate that their corresponding parameter is required, there is no default value, and if a client attempts to create a draw_parameters missing any of these entries an error will be produced at compile time.</p>
<p>Note that the actual type of the result of a call to the parameter_description function is unspecified. But it is guaranteed to have a member type alias named actual_parameters_type, which you can use in your function’s signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">draw_parameters</span> <span class="o">=</span> <span class="n">decltype</span><span class="p">(</span><span class="n">draw_parameters_desc</span><span class="p">)::</span><span class="n">actual_parameters_type</span><span class="p">;</span>

<span class="n">void</span> <span class="n">draw_page</span><span class="p">(</span><span class="n">document</span><span class="o">&amp;</span> <span class="n">doc</span><span class="p">,</span> <span class="n">draw_parameters</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">params</span><span class="p">);</span>
</pre></div>
</div>
<p>Now, desc is just a description–a grammar, if you will–of the parameters expected for an invocation of draw_page. A single process might invoke draw_page with a whole host of different combinations of parameters. Although draw_parameters_desc’s actual type is an implementation detail, you can access the actual_parameters_type member typedef, which identifies a type appropriate to holding a collection of parameter values appropriate to an invocation of draw_page. Instances of actual_parameters_type are essentially strongly typed “parameter dictionaries.”</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Under the hood, the actual_parameters_type is a wrapper class around a hana::tuple mapping parameter tags to real, runtime values.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">draw_page</span><span class="p">(</span><span class="n">document</span><span class="o">&amp;</span> <span class="n">doc</span><span class="p">,</span> <span class="n">draw_parameters</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">params</span><span class="p">);</span>
</pre></div>
</div>
<p>This is the new definition of the draw_page API. It takes a const reference to a draw_parameters instance, from which it extracts the individual parameters and draws the corresponding page.</p>
</div>
<div class="section" id="extracting-parameters-from-a-parameters-dictionary">
<h3>Extracting Parameters from a Parameters Dictionary<a class="headerlink" href="#extracting-parameters-from-a-parameters-dictionary" title="Permalink to this headline">¶</a></h3>
<p>Extracting parameters from an instance of draw_parameters is easy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">draw_page</span><span class="p">(</span><span class="n">document</span><span class="o">&amp;</span> <span class="n">doc</span><span class="p">,</span> <span class="n">draw_parameters</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">params</span><span class="p">)</span>
<span class="p">{</span>
        <span class="n">using</span> <span class="n">namespace</span> <span class="n">d_params</span><span class="p">;</span>
        <span class="n">page_num</span> <span class="n">p</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="o">&lt;</span><span class="n">page</span><span class="o">&gt;</span><span class="p">();</span>
        <span class="n">affine_transform</span> <span class="n">x</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="o">&lt;</span><span class="n">xform</span><span class="o">&gt;</span><span class="p">();</span>
        <span class="n">int_rect</span> <span class="n">c</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="o">&lt;</span><span class="n">clip</span><span class="o">&gt;</span><span class="p">();</span>
        <span class="n">writable_pixels</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">pix</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="o">&lt;</span><span class="n">buffer</span><span class="o">&gt;</span><span class="p">();</span>

        <span class="n">draw_page_inner</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">pix</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="invoking-a-t4-params-based-api">
<h3>Invoking a T4 Params-Based API<a class="headerlink" href="#invoking-a-t4-params-based-api" title="Permalink to this headline">¶</a></h3>
<p>Here’s how a client might invoke draw_page:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">draw_page</span><span class="p">(</span><span class="n">my_doc</span><span class="p">,</span> <span class="n">draw_params</span><span class="p">(</span>
        <span class="n">parameter</span><span class="o">&lt;</span><span class="n">page</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>
        <span class="n">parameter</span><span class="o">&lt;</span><span class="n">buffer</span><span class="o">&gt;</span><span class="p">(</span><span class="n">my_buffer</span><span class="p">),</span>
        <span class="n">parameter</span><span class="o">&lt;</span><span class="n">clip</span><span class="o">&gt;</span><span class="p">(</span><span class="n">make</span><span class="o">&lt;</span><span class="n">int_rect</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)),</span>
        <span class="n">parameter</span><span class="o">&lt;</span><span class="n">xform</span><span class="o">&gt;</span><span class="p">(</span><span class="n">identity</span><span class="o">&lt;</span><span class="n">affine_transform</span><span class="o">&gt;</span><span class="p">()));</span>
</pre></div>
</div>
<p>Let’s get one thing out of the way here: this is a more cumbersome syntax than the traditional sequence of parameters. This is not something you would do for a more traditional API where you don’t expect to be grappling with these complexities. However, there are some advantages:</p>
<ol class="arabic simple">
<li><p>Each parameter’s role is explictly tagged. It is much harder to get adjacent boolean or integral arguments mixed up.</p></li>
<li><p>Clients are free to specify parameters in any order.</p></li>
<li><p>This is completely type-safe, and all the heavy lifting is done at compile time.</p></li>
</ol>
</div>
<div class="section" id="evolving-a-t4-params-based-api">
<h3>Evolving a T4 Params-Based API<a class="headerlink" href="#evolving-a-t4-params-based-api" title="Permalink to this headline">¶</a></h3>
<p>Now let’s consider what happens when we add the optional reflow layout and greek threshold parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;t4/params.hpp&quot;</span>

<span class="n">using</span> <span class="n">namespace</span> <span class="n">t4</span><span class="p">;</span>

<span class="n">namespace</span> <span class="n">d_params</span> <span class="p">{</span>

<span class="n">struct</span> <span class="n">page</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="n">pdf</span><span class="p">::</span><span class="n">page_num</span><span class="o">&gt;</span> <span class="p">{};</span>
<span class="n">struct</span> <span class="n">xform</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="n">affine_transform</span><span class="o">&gt;</span> <span class="p">{};</span>
<span class="n">struct</span> <span class="n">clip</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="n">int_rect</span><span class="o">&gt;</span> <span class="p">{};</span>
<span class="n">struct</span> <span class="n">buffer</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="n">writable_pixels</span> <span class="n">const</span><span class="o">&amp;&gt;</span> <span class="p">{};</span>
<span class="n">struct</span> <span class="n">reflow</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="n">pdf</span><span class="p">::</span><span class="n">reflow_layout_params</span><span class="o">&gt;</span> <span class="p">{};</span>
<span class="n">struct</span> <span class="n">greek_threshold</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="n">size_t</span><span class="o">&gt;</span> <span class="p">{};</span>

<span class="p">}</span> <span class="o">//</span> <span class="n">end</span> <span class="n">namespace</span> <span class="n">d_params</span>

<span class="n">using</span> <span class="n">namespace</span> <span class="n">d_params</span><span class="p">;</span>
<span class="n">constexpr</span> <span class="n">auto</span> <span class="n">draw_parameters_desc</span> <span class="o">=</span> <span class="n">parameter_description</span><span class="p">(</span>
        <span class="n">required_parameter</span><span class="o">&lt;</span><span class="n">page</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="n">required_parameter</span><span class="o">&lt;</span><span class="n">xform</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="n">required_parameter</span><span class="o">&lt;</span><span class="n">clip</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="n">required_parameter</span><span class="o">&lt;</span><span class="n">buffer</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="n">optional_parameter</span><span class="o">&lt;</span><span class="n">reflow</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="n">required_parameter</span><span class="o">&lt;</span><span class="n">greek_threshold</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>

<span class="n">using</span> <span class="n">draw_parameters</span> <span class="o">=</span> <span class="n">decltype</span><span class="p">(</span><span class="n">draw_parameters_desc</span><span class="p">)::</span><span class="n">actual_parameters_type</span><span class="p">;</span>

<span class="n">void</span> <span class="n">draw_page</span><span class="p">(</span><span class="n">document</span><span class="o">&amp;</span> <span class="n">doc</span><span class="p">,</span> <span class="n">draw_parameters</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">params</span><span class="p">);</span>
</pre></div>
</div>
<p>There are really only two changes here: we introduced new reflow and greek_threshold tags (with a value of type reflow_layout and size_t) and added them to draw_formal_params. We used optional_param to indicate that the reflow parameter is optional, and we used the call operator to specify that greek_threshold is required, but if the client omits it, we will default to the value 2.</p>
<p>Because reflow is optional and greek_threshold both come with default values, existing call sites don’t require any modification and will work as they always did. But modifying calling code to use these new parameters is easy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">using</span> <span class="n">namespace</span> <span class="n">d_params</span><span class="p">;</span>
<span class="n">draw_page</span><span class="p">(</span><span class="n">my_doc</span><span class="p">,</span> <span class="n">draw_parameters</span><span class="p">(</span>
        <span class="n">parameter</span><span class="o">&lt;</span><span class="n">page</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>
        <span class="n">parameter</span><span class="o">&lt;</span><span class="n">buffer</span><span class="o">&gt;</span><span class="p">(</span><span class="n">my_buffer</span><span class="p">),</span>
        <span class="n">parameter</span><span class="o">&lt;</span><span class="n">clip</span><span class="o">&gt;</span><span class="p">(</span><span class="n">make</span><span class="o">&lt;</span><span class="n">int_rect</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)),</span>
        <span class="n">parameter</span><span class="o">&lt;</span><span class="n">xform</span><span class="o">&gt;</span><span class="p">(</span><span class="n">identity</span><span class="o">&lt;</span><span class="n">affine_transform</span><span class="o">&gt;</span><span class="p">()),</span>
        <span class="n">parameter</span><span class="o">&lt;</span><span class="n">reflow</span><span class="o">&gt;</span><span class="p">(</span><span class="n">pdf</span><span class="p">::</span><span class="n">reflow_layout_params</span><span class="p">(</span><span class="mi">200</span><span class="p">)),</span>
        <span class="n">parameter</span><span class="o">&lt;</span><span class="n">greek_threshold</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">5</span><span class="p">)));</span>
</pre></div>
</div>
</div>
<div class="section" id="compile-time-errors">
<h3>Compile-Time Errors<a class="headerlink" href="#compile-time-errors" title="Permalink to this headline">¶</a></h3>
<p>One of the huge benefits of the T4 Params system is that if you omit any required parameters (that have no defaults) you’ll get a moderately helpful compiler error telling you what you forgot. Compiling this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">draw_page</span><span class="p">(</span><span class="n">my_doc</span><span class="p">,</span> <span class="n">draw_parameters</span><span class="p">(</span>
        <span class="o">//</span> <span class="n">Missing</span> <span class="n">required</span> <span class="n">parameter</span><span class="o">&lt;</span><span class="n">page</span><span class="o">&gt;</span>
        <span class="n">parameter</span><span class="o">&lt;</span><span class="n">buffer</span><span class="o">&gt;</span><span class="p">(</span><span class="n">my_buffer</span><span class="p">),</span>
        <span class="n">parameter</span><span class="o">&lt;</span><span class="n">clip</span><span class="o">&gt;</span><span class="p">(</span><span class="n">make</span><span class="o">&lt;</span><span class="n">int_rect</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)),</span>
        <span class="n">parameter</span><span class="o">&lt;</span><span class="n">xform</span><span class="o">&gt;</span><span class="p">(</span><span class="n">identity</span><span class="o">&lt;</span><span class="n">affine_transform</span><span class="o">&gt;</span><span class="p">()),</span>
        <span class="n">parameter</span><span class="o">&lt;</span><span class="n">reflow</span><span class="o">&gt;</span><span class="p">(</span><span class="n">pdf</span><span class="p">::</span><span class="n">reflow_layout_params</span><span class="p">(</span><span class="mi">200</span><span class="p">)),</span>
        <span class="n">parameter</span><span class="o">&lt;</span><span class="n">greek_threshold</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">5</span><span class="p">)));</span>
</pre></div>
</div>
<p>produces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">../../../</span><span class="n">t4</span><span class="o">/</span><span class="n">detail</span><span class="o">/</span><span class="n">params</span><span class="o">.</span><span class="n">hpp</span><span class="p">:</span><span class="mi">138</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span> <span class="n">error</span><span class="p">:</span> <span class="n">static_assert</span> <span class="n">failed</span> <span class="s2">&quot;Failure to provide required parameter&quot;</span>
        <span class="n">static_assert</span><span class="p">(</span> <span class="n">mp</span><span class="p">::</span><span class="n">failure</span><span class="o">&lt;</span><span class="n">MissingParameterName</span><span class="o">&gt;</span><span class="p">,</span> <span class="s2">&quot;Failure to provide required parameter&quot;</span> <span class="p">);</span>
        <span class="o">^</span>              <span class="o">~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
<span class="o">../../../</span><span class="n">t4</span><span class="o">/</span><span class="n">detail</span><span class="o">/</span><span class="n">params</span><span class="o">.</span><span class="n">hpp</span><span class="p">:</span><span class="mi">172</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span> <span class="n">note</span><span class="p">:</span> <span class="ow">in</span> <span class="n">instantiation</span> <span class="n">of</span> <span class="n">function</span> <span class="n">template</span> <span class="n">specialization</span> <span class="s1">&#39;t4::parameter_detail::extract_default_value&lt;d_params::page, int&gt;&#39;</span> <span class="n">requested</span> <span class="n">here</span>
        <span class="k">return</span> <span class="n">extract_default_value</span><span class="o">&lt;</span><span class="n">Parameter</span><span class="o">&gt;</span><span class="p">(</span> <span class="n">formals</span><span class="p">[</span> <span class="n">hana</span><span class="p">::</span><span class="n">type_c</span><span class="o">&lt;</span><span class="n">Parameter</span><span class="o">&gt;</span> <span class="p">]</span> <span class="p">);</span>
</pre></div>
</div>
<p>It’s not great, but the static assertion makes it clear that you need to provide a required parameter, and if you look at the line below you can see that the problematic parameter tag is d_params::page.</p>
</div>
<div class="section" id="recommended-hybrid-approach">
<h3>Recommended: Hybrid Approach<a class="headerlink" href="#recommended-hybrid-approach" title="Permalink to this headline">¶</a></h3>
<p>In the above example, I’ve lumped all the parameters (except the document parameter) into the draw_params mechanism. For required arguments with no default values, there isn’t much of a compelling reason to use the T4 Params mechanism. Clients can reorder parameters however they like, which is nice; but the syntax is admittedly less concise than the strongly typed, ordered, but unnamed idiom we’ve been using since we cracked open our first copy of K&amp;R.</p>
<p>In practice I would recommend a hybrid model, where arguments that are 1) required and 2) have no default values are passed using the traditional model, and all others get lumped into the T4 parameters mechanism. So ultimately I would write the above this way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#include &quot;t4/params.hpp&quot;</span>

<span class="n">using</span> <span class="n">namespace</span> <span class="n">t4</span><span class="p">;</span>

<span class="n">namespace</span> <span class="n">d_params</span> <span class="p">{</span>

<span class="n">struct</span> <span class="n">reflow</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="n">pdf</span><span class="p">::</span><span class="n">reflow_layout_params</span><span class="o">&gt;</span> <span class="p">{};</span>
<span class="n">struct</span> <span class="n">greek_threshold</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="n">size_t</span><span class="o">&gt;</span> <span class="p">{};</span>

<span class="p">}</span> <span class="o">//</span> <span class="n">end</span> <span class="n">namespace</span> <span class="n">d_params</span>

<span class="n">using</span> <span class="n">namespace</span> <span class="n">d_params</span><span class="p">;</span>
<span class="n">constexpr</span> <span class="n">auto</span> <span class="n">draw_parameter_desc</span> <span class="o">=</span> <span class="n">parameter_description</span><span class="p">(</span>
        <span class="n">optional_parameter</span><span class="o">&lt;</span><span class="n">reflow</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="n">required_parameter</span><span class="o">&lt;</span><span class="n">greek_threshold</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span>

<span class="n">using</span> <span class="n">draw_parameters</span> <span class="o">=</span> <span class="n">decltype</span><span class="p">(</span><span class="n">draw_parameter_desc</span><span class="p">)::</span><span class="n">actual_parameters_type</span><span class="p">;</span>

<span class="n">void</span> <span class="n">draw_page</span><span class="p">(</span><span class="n">document</span><span class="o">&amp;</span> <span class="n">doc</span><span class="p">,</span>
        <span class="n">page_num</span> <span class="n">page</span><span class="p">,</span>
        <span class="n">affine_transform</span> <span class="n">xform</span><span class="p">,</span>
        <span class="n">int_rect</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">clip</span><span class="p">,</span>
        <span class="n">writable_pixels</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">buffer</span><span class="p">,</span>
        <span class="n">draw_parameters</span> <span class="n">const</span><span class="o">&amp;</span> <span class="n">params</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="about-parameter-values">
<h3>About Parameter Values<a class="headerlink" href="#about-parameter-values" title="Permalink to this headline">¶</a></h3>
<p>Parameter tag types are specified in T4 using the parameter_of_type template class, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">struct</span> <span class="n">sprocket</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="p">{};</span>
</pre></div>
</div>
<p>As mentioned above, the type passed into the parameter_of_type may be a reference or a value; if a value, the type must be MoveConstructible. This means that, in addition to obviously useful types like int, real_rect, and double, you can efficiently use container types like vector&lt;real_point&gt; without worrying about unnecessary copies being made under the hood, and you can use noncopyable types like unique_ptr&lt;widget&gt; or data_block_stream.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using parameter tags whose values are movable but not copyable (e.g., unique_ptr&lt;widget&gt;), you must take care to use instances of actual_parameters_type carefully. const references to actual_parameter_type are less useful, since you can’t “move” the parameter value somewhere useful. For this reason you might consider making your T4 Params-savvy APIs take its parameters by rvalue reference or by value.</p>
</div>
</div>
<div class="section" id="required-value-parameters">
<h3>Required Value Parameters<a class="headerlink" href="#required-value-parameters" title="Permalink to this headline">¶</a></h3>
<p>The template parameter to parameter_of_type identifies the value type of parameters using the sprocket name. In this example, the value type is int. So, given a parameter description like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">constexpr</span> <span class="n">auto</span> <span class="n">my_param_desc</span> <span class="o">=</span> <span class="n">parameter_description</span><span class="p">(</span>
        <span class="n">required_parameter</span><span class="o">&lt;</span><span class="n">sprocket</span><span class="o">&gt;</span><span class="p">);</span>
</pre></div>
</div>
<p>And an “invocation” of this description like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">auto</span> <span class="n">my_params</span> <span class="o">=</span> <span class="n">my_param_desc</span><span class="p">(</span><span class="n">parameter</span><span class="o">&lt;</span><span class="n">sprocket</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">23</span><span class="p">));</span>
</pre></div>
</div>
<p>We would expect the type of the expression my_params.get&lt;sprocket&gt; to be int, and the following to hold:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span><span class="p">(</span><span class="n">my_params</span><span class="o">.</span><span class="n">get</span><span class="o">&lt;</span><span class="n">sprocket</span><span class="o">&gt;</span> <span class="o">==</span> <span class="mi">3</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="required-reference-parameters">
<h3>Required Reference Parameters<a class="headerlink" href="#required-reference-parameters" title="Permalink to this headline">¶</a></h3>
<p>T4 Params supports parameters of reference type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">struct</span> <span class="n">sprocket_ref</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&amp;&gt;</span> <span class="p">{};</span>
<span class="n">struct</span> <span class="n">const_sprocket_ref</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="nb">int</span> <span class="n">const</span><span class="o">&amp;&gt;</span> <span class="p">{};</span>
</pre></div>
</div>
<p>Now this won’t compile, because 23 is not a reference:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">auto</span> <span class="n">my_params</span> <span class="o">=</span> <span class="n">my_param_desc</span><span class="p">(</span><span class="n">parameter</span><span class="o">&lt;</span><span class="n">sprocket_ref</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">23</span><span class="p">));</span>
</pre></div>
</div>
<p>But this will:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span> <span class="n">zzz</span><span class="p">;</span>
<span class="n">auto</span> <span class="n">my_params</span> <span class="o">=</span> <span class="n">my_param_desc</span><span class="p">(</span><span class="n">parameter</span><span class="o">&lt;</span><span class="n">sprocket</span><span class="o">&gt;</span><span class="p">(</span><span class="n">zzz</span><span class="p">));</span>
</pre></div>
</div>
<p>And the following will hold:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Verify</span> <span class="n">that</span> <span class="n">the</span> <span class="n">retrieved</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">indeed</span> <span class="n">referring</span> <span class="n">to</span> <span class="n">the</span> <span class="n">original</span> <span class="n">value</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="p">,</span> <span class="n">has</span> <span class="n">the</span> <span class="n">same</span> <span class="n">address</span> <span class="ow">in</span> <span class="n">memory</span>
<span class="k">assert</span><span class="p">(</span><span class="o">&amp;</span><span class="n">my_params</span><span class="o">.</span><span class="n">get</span><span class="o">&lt;</span><span class="n">sprocket</span><span class="o">&gt;</span> <span class="o">==</span> <span class="o">&amp;</span><span class="n">zzz</span><span class="p">);</span>
</pre></div>
</div>
<p>As you already know, references can make lifetime analysis tricky. It’s your job to make sure that zzz “outlives” any set of parameters that happens to be referring to it.</p>
</div>
<div class="section" id="optional-parameters">
<h3>Optional Parameters<a class="headerlink" href="#optional-parameters" title="Permalink to this headline">¶</a></h3>
<p>Now let’s suppose we make the sprocket parameter optional:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">constexpr</span> <span class="n">auto</span> <span class="n">my_param_desc</span> <span class="o">=</span> <span class="n">parameter_description</span><span class="p">(</span>
        <span class="n">optional_parameter</span><span class="o">&lt;</span><span class="n">sprocket</span><span class="o">&gt;</span><span class="p">);</span>
</pre></div>
</div>
<p>Now it’s valid for a client to provide a value for the int-valued sprocket parameter, or they may omit it. So both of the following definitions are valid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">auto</span> <span class="n">my_params_required</span> <span class="o">=</span> <span class="n">my_param_desc</span><span class="p">(</span><span class="n">parameter</span><span class="o">&lt;</span><span class="n">sprocket</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">23</span><span class="p">));</span>
<span class="n">auto</span> <span class="n">my_params_optional</span> <span class="o">=</span> <span class="n">my_param_desc</span><span class="p">();</span>
</pre></div>
</div>
<p>Now it’s clear that the return type of the call to get needs to change: we need to somehow make it possible to express to the consumer of the parameters that the sprocket parameter might not exist. We do this by changing the return type of get; when a parameter is optional the return type of the corresponding call to get is a boost::optional wrapped around the “real” value, if any:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>boost::optional&lt;int&gt; r = my_params_required.get&lt;sprocket&gt;();
boost::optional&lt;int&gt; o = my_params_optional.get&lt;sprocket&gt;();
assert(r);
assert(*r == 23);
assert(!o);
</pre></div>
</div>
<p>Even reference-valued parameters can be optional. The following code is perfectly valid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">constexpr</span> <span class="n">auto</span> <span class="n">my_param_desc</span> <span class="o">=</span> <span class="n">parameter_description</span><span class="p">(</span>
        <span class="n">optional_parameter</span><span class="o">&lt;</span><span class="n">sprocket_ref</span><span class="o">&gt;</span><span class="p">);</span>

<span class="nb">int</span> <span class="n">zzz</span><span class="p">;</span>
<span class="n">auto</span> <span class="n">my_params_present</span> <span class="o">=</span> <span class="n">my_param_desc</span><span class="p">(</span><span class="n">parameter</span><span class="o">&lt;</span><span class="n">sprocket_ref</span><span class="o">&gt;</span><span class="p">(</span><span class="n">zzz</span><span class="p">))</span><span class="n">p</span>
<span class="n">auto</span> <span class="n">my_params_absent</span> <span class="o">=</span> <span class="n">my_param_desc</span><span class="p">();</span>
</pre></div>
</div>
<p>And the return type of get for sprocket_ref is a boost::optional&lt;int&amp;&gt;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>boost::optional&lt;int&amp;&gt; p = my_params_present.get&lt;sprocket_ref&gt;();
boost::optional&lt;int&amp;&gt; a = my_params_absent.get&lt;sprocket_ref&gt;();
assert(p);
assert(&amp;*p == &amp;zzz);
assert(!a);
</pre></div>
</div>
</div>
<div class="section" id="required-parameters-with-default-values">
<h3>Required Parameters with Default Values<a class="headerlink" href="#required-parameters-with-default-values" title="Permalink to this headline">¶</a></h3>
<p>In the parameter description, you can provide a default value for a required parameter. Clients who omit this parameter from their parameter lists will produce mappings to this default value. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">constexpr</span> <span class="n">auto</span> <span class="n">my_param_desc</span> <span class="o">=</span> <span class="n">parameter_description</span><span class="p">(</span>
        <span class="n">required_parameter</span><span class="o">&lt;</span><span class="n">sprocket</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">500</span><span class="p">));</span>
</pre></div>
</div>
<p>Parameter creation looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">auto</span> <span class="n">my_params_specified</span> <span class="o">=</span> <span class="n">my_param_desc</span><span class="p">(</span><span class="n">parameter</span><span class="o">&lt;</span><span class="n">sprocket</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">42</span><span class="p">));</span>
<span class="n">auto</span> <span class="n">my_params_defaulted</span> <span class="o">=</span> <span class="n">my_param_desc</span><span class="p">();</span>

<span class="k">assert</span><span class="p">(</span><span class="n">my_params_specified</span><span class="o">.</span><span class="n">get</span><span class="o">&lt;</span><span class="n">sprocket</span><span class="o">&gt;</span><span class="p">()</span> <span class="o">==</span> <span class="mi">42</span><span class="p">);</span>
<span class="k">assert</span><span class="p">(</span><span class="n">my_params_defaulted</span><span class="o">.</span><span class="n">get</span><span class="o">&lt;</span><span class="n">sprocket</span><span class="o">&gt;</span><span class="p">()</span> <span class="o">==</span> <span class="mi">500</span><span class="p">);</span>
</pre></div>
</div>
<p>You can use the defaulting mechanism on reference-valued parameters as well. You must somehow be certain that the default referent outlives any parameter list created from that parameter description, though. Typically this is achieved by putting the default referent in the global scope.</p>
<p>It is not possible to create optional parameters with default values. As of this writing, if a parameter is optional, its default value is implicitly the uninitialized state.</p>
</div>
<div class="section" id="parameter-descriptions-and-constexpr">
<h3>Parameter Descriptions and constexpr<a class="headerlink" href="#parameter-descriptions-and-constexpr" title="Permalink to this headline">¶</a></h3>
<p>Parameter descriptions can frequently be constexpr, which might allow the compiler to push some of the computation to compile time and allows you, the author, to statically check assertions at compile time. But you can’t always. For example, the following won’t compile:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">struct</span> <span class="n">shared_ogre</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">ogre</span><span class="o">&gt;&gt;</span> <span class="p">{};</span>
<span class="n">struct</span> <span class="n">marble_count</span> <span class="p">:</span> <span class="n">parameter_of_type</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span> <span class="p">{};</span>

<span class="n">constexpr</span> <span class="n">auto</span> <span class="n">my_param_list</span> <span class="o">=</span> <span class="n">parameter_description</span><span class="p">(</span>
        <span class="n">required_parameter</span><span class="o">&lt;</span><span class="n">marble_count</span><span class="o">&gt;</span><span class="p">,</span>
        <span class="n">required_parameter</span><span class="o">&lt;</span><span class="n">shared_ogre</span><span class="o">&gt;</span><span class="p">(</span><span class="n">std</span><span class="p">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">ogre</span><span class="o">&gt;</span><span class="p">()));</span>
</pre></div>
</div>
<p>This fails because my_param_list’s definition can’t be completely computed at compile time, because you can’t create a shared_ptr at compile time. The solution here is to drop the constexpr. While it’s a good practice to declare parameter descriptions constexpr when you can, you can’t always do that.</p>
</div>
<div class="section" id="abi-issues">
<h3>ABI Issues<a class="headerlink" href="#abi-issues" title="Permalink to this headline">¶</a></h3>
<p>Modification of a parameter description is an ABI-breaking change: as with pretty much everything else in T4, if you change a .hpp file all your clients will have to recompile and re-link to an updated build of your library. But, unless you add a required parameter descriptor with no default value, client code should not have to be modified.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Adobe Inc..
      <span class="lastupdated">
        Last update: Aug 30, 2021. 
        <img src="../_static/adobelogo.png" class="logo"/> 
      </span>

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>